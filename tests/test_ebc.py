import unittest

from ebc import EBC

from matrix import SparseMatrix


class TestEbc(unittest.TestCase):
    def setUp(self):
        self.data = [["0", "0", 0.05],
                     ["0", "1", 0.05],
                     ["0", "2", 0.05],
                     ["0", "3", 0.00],
                     ["0", "4", 0.00],
                     ["0", "5", 0.00],
                     ["1", "0", 0.05],
                     ["1", "1", 0.05],
                     ["1", "2", 0.05],
                     ["1", "3", 0.00],
                     ["1", "4", 0.00],
                     ["1", "5", 0.00],
                     ["2", "0", 0.00],
                     ["2", "1", 0.00],
                     ["2", "2", 0.00],
                     ["2", "3", 0.05],
                     ["2", "4", 0.05],
                     ["2", "5", 0.05],
                     ["3", "0", 0.00],
                     ["3", "1", 0.00],
                     ["3", "2", 0.00],
                     ["3", "3", 0.05],
                     ["3", "4", 0.05],
                     ["3", "5", 0.05],
                     ["4", "0", 0.04],
                     ["4", "1", 0.04],
                     ["4", "2", 0.00],
                     ["4", "3", 0.04],
                     ["4", "4", 0.04],
                     ["4", "5", 0.04],
                     ["5", "0", 0.04],
                     ["5", "1", 0.04],
                     ["5", "2", 0.04],
                     ["5", "3", 0.00],
                     ["5", "4", 0.04],
                     ["5", "5", 0.04]]
        self.matrix = SparseMatrix(2, [6, 6])
        self.matrix.read_data(self.data)

    def testDataLoad(self):
        self.assertEquals(self.matrix.M, {(1, 2): 0.05, (3, 2): 0.0, (0, 0): 0.05, (5, 0): 0.04,
                                          (3, 0): 0.0, (0, 4): 0.0, (5, 4): 0.04, (1, 4): 0.0,
                                          (5, 5): 0.04, (1, 3): 0.0, (0, 5): 0.0, (2, 1): 0.0,
                                          (5, 1): 0.04, (4, 2): 0.0, (2, 5): 0.05, (1, 0): 0.05,
                                          (3, 5): 0.05, (0, 1): 0.05, (5, 3): 0.0, (4, 1): 0.04,
                                          (0, 2): 0.05, (3, 3): 0.05, (1, 5): 0.0, (3, 4): 0.05,
                                          (3, 1): 0.0, (5, 2): 0.04, (4, 4): 0.04, (1, 1): 0.05,
                                          (2, 0): 0.0, (4, 3): 0.04, (2, 2): 0.0, (4, 5): 0.04,
                                          (2, 3): 0.05, (4, 0): 0.04, (0, 3): 0.0, (2, 4): 0.05})

    def testStepOne(self):
        ebc = EBC(self.matrix, [3, 2], 10)
        ebc.run_ebc(assigned_C=[[2, 0, 1, 1, 2, 2], [0, 0, 1, 0, 1, 1]])
